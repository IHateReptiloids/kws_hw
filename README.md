# Домашнее задание по KWS
[Условие](https://github.com/markovka17/dla/tree/2021/hw2_kws)

## Перед тем, как воспроизвести
```
pip install -r requirements.txt -f https://download.pytorch.org/whl/cu113/torch_stable.html
```

## Что где находится
1. В папке `checkpoints/` лежат веса всех нужных предобученных моделей, там же находится их описания и то, как они были получены.
2. В папке `data/` лежит разделение на `train` и `val`, на котором я замерял качество всех моделей. Это разделение сгенерировано командой `python train_val_split.py`, её результаты воспроизводятся.
3. В папке `src/` находится почти весь код, часть скопирована с семинара, часть написана мной.
4. В `baseline.ipynb` можно найти код обучения изначальной модели и график обучения. Его результаты воспроизводятся(вроде).
5. В `distillation.ipynb` можно найти код обучения и конфигурации всех student-моделей, а также графики их обучения. Его результаты воспроизводятся(вроде).
6. В `streaming_demo.ipynb` находится демонстрация работы стриминговой модели. Результаты воспроизводятся.
7. В `train_val_split.py` я приложил код, который генерирует мое разделение на `train` и `val`, чтобы никто не сказал, что я обманщик и каким-то хитрым образом подобрал такое разделение, на котором качество хорошее.
8. В `comparison.ipynb` проводится сравнение всех рассмотренных моделей с графиками и комментариями.
9. `report.pdf` - отчет.

## Выполненная работа
1. Воспроизведена модель с семинара. Код обучения находится в `baseline.ipynb`, веса модели сохранены в файле `checkpoints/baseline.pth`. Качество на валидации примерно `1.6e-5`.
2. Реализован стриминг. Модель находится в файле `src/models/streaming_crnn.py`. Также приведен пример его работы в `streaming_demo.ipynb`.
3. Проведены эксперименты с дистилляцией. Более подробное описание есть в отчете, код с графиками есть в `distillation.ipynb`. Веса моделей и их описания находятся в папке `checkpoints/`.
4. Проведены эксперименты с квантизацией. Опять-таки, подробнее можно посмотреть в отчете или в `comparison.ipynb`.

## Результаты
Веса самой маленькой модели находятся в файле `checkpoints/distillated_hs16_c4.pth`. Она ускоряет baseline в 10 раз и уменьшает потребление памяти в 38 раз(после квантизации). При этом качество на валидации у нее `4.9e-5`. Более подробное сравнение с baseline и другими моделями можно посмотреть в `comparison.ipynb`.
